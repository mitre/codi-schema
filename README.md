# pcor-cdm
This project reads in the [PCORnet Common Data Model v4.1 Parseable Spreadsheet Format](https://github.com/CDMFORUM/CDM-GUIDANCE/raw/master/Files%20for%20CDM%20page/2018-12-05-PCORnet-Common-Data-Model-v4dot1-parseable.xlsx) and will create database tables to represent the CDM.

This application is written in Ruby and it uses the [Sequel](http://sequel.jeremyevans.net/index.html) library to generate the appropriate DDL.

This script currently creates the tables, sets not null constraints and primary keys. It does not yet handle creating the foreign key relationships.

**Note** The CSV files were created using Excel to open the parseable file and then perform an export to CSV. Excel will put a Byte Order Marker (BOM) in the file, which throws off the standard ruby CSV parsing library. The CSV files were re-encoded to UTF-8 using Visual Studio Code.

**Note** The CODI Ancillary Tables SQL was generated by an external tool. Original materials can be found on the [CODI SharePoint Site](https://communityshare.mitre.org/sites/CODI/SitePages/Home.aspx?RootFolder=%2Fsites%2FCODI%2FShared%20Documents%2FTasks%202-4-6%20Data%20Model%20Development%20and%20Implementation%2FData%20Model%20Recommendations&FolderCTID=0x012000FB06469179A8EA45AD22A72721DC2502&View=%7BA7E27498-CE3A-4A93-8D50-CD0BFADD9613%7D)

## Prerequisites

This was built using ruby 2.6.2. It used inline [Bundler](https://bundler.io/) to manage dependencies. Assuming you have ruby installed, you can:

    gem install bundler

## Running

Just run the script:

    ruby build_db.rb

The connection information exists in the ruby file. It assumes that the database has been created and is empty. It will create all of the columns after that.
